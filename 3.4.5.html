<!DOCTYPE html>
<html lang="pl" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="pageTitle">Interaktywny przewodnik: Zaawansowane łączenie modeli</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto+Mono:wght@400;500&display=swap');
        
        :root {
            --bg-color: #0d0c1d;
            --primary-color: #be00ff; 
            --secondary-color: #00f0ff;
            --text-color: #e0e0e0;
            --text-muted-color: #a0a0c0;
            --border-color: rgba(0, 240, 255, 0.2);
            --glow-color-primary: rgba(190, 0, 255, 0.5);
            --glow-color-secondary: rgba(0, 240, 255, 0.4);
        }

        html { scroll-padding-top: 5rem; }
        
        body { 
            font-family: 'Roboto Mono', monospace; 
            background-color: var(--bg-color); 
            color: var(--text-color);
            background-image: 
                linear-gradient(rgba(0, 240, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 240, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        #shader-canvas { 
            position: fixed; 
            top: 0; left: 0; 
            width: 100%; height: 100%; 
            z-index: -1; opacity: 0.15; 
        }

        .scanlines::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image: linear-gradient(rgba(0,0,0,0.4) 50%, transparent 50%);
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
            opacity: 0.5;
        }

        .content-wrapper { position: relative; z-index: 1; }
        .chart-container { position: relative; width: 100%; max-width: 900px; margin: auto; height: 400px; max-height: 50vh; }
        @media (min-width: 768px) { .chart-container { height: 450px; } }

        h1, h2, h3 { font-family: 'Orbitron', sans-serif; text-shadow: 0 0 8px var(--glow-color-secondary); }

        .card {
            background: linear-gradient(145deg, rgba(20, 19, 41, 0.7), rgba(13, 12, 29, 0.8));
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid var(--border-color);
            border-radius: 0; /* Sharp edges */
            transition: all 0.3s ease;
            box-shadow: inset 0 0 15px rgba(0, 240, 255, 0.1), 0 0 10px rgba(0,0,0,0.5);
            position: relative;
        }

        .card:hover {
            border-color: var(--secondary-color);
            box-shadow: inset 0 0 20px rgba(0, 240, 255, 0.2), 0 0 20px var(--glow-color-secondary), 0 0 10px rgba(0,0,0,0.5);
            transform: translateY(-2px);
        }

        .version-btn, .recipe-btn, .lang-btn {
            font-family: 'Orbitron', sans-serif;
            background-color: transparent;
            color: var(--secondary-color);
            border: 1px solid var(--border-color);
            box-shadow: inset 0 0 8px rgba(0, 240, 255, 0.2);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 0;
        }

        .version-btn:hover, .recipe-btn:hover, .lang-btn:hover {
            background-color: var(--border-color);
            color: white;
            box-shadow: inset 0 0 10px rgba(0, 240, 255, 0.4), 0 0 15px var(--glow-color-secondary);
        }

        .version-btn.active, .recipe-btn.active, .lang-btn.active {
            background-color: var(--secondary-color);
            color: var(--bg-color);
            border-color: var(--secondary-color);
            box-shadow: 0 0 20px var(--glow-color-secondary);
        }

        .dare-panel {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--border-color);
            padding: 1.5rem;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .flow-arrow { font-family: 'Roboto Mono', monospace; }
        
        .info-panel {
            background-color: rgba(190, 0, 255, 0.05);
            border: 1px solid rgba(190, 0, 255, 0.3);
            color: var(--text-color);
        }
    </style>
</head>
<body class="bg-slate-900">
    <canvas id="shader-canvas"></canvas>
    <div class="content-wrapper">
        <header class="bg-black/50 backdrop-blur-lg sticky top-0 z-50 border-b-2 border-primary-color shadow-[0_0_25px_var(--glow-color-primary)]">
            <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center">
                        <span class="font-bold text-lg text-slate-100" data-i18n-key="guideTitle"></span>
                    </div>
                    <div class="flex items-center space-x-8">
                        <div id="main-nav" class="flex items-center space-x-4 text-sm font-medium">
                            <a id="nav-blueprints" href="#sdxl-blueprints" class="text-slate-300 hover:text-white transition-colors" data-i18n-key="nav.blueprints"></a>
                            <a id="nav-recipes" href="#sdxl-recipes" class="text-slate-300 hover:text-white transition-colors" data-i18n-key="nav.recipes"></a>
                            <a href="#analysis" class="text-slate-300 hover:text-white transition-colors" data-i18n-key="nav.analysis"></a>
                            <a href="#glossary" class="text-slate-300 hover:text-white transition-colors" data-i18n-key="nav.glossary"></a>
                        </div>
                         <div class="flex items-center">
                            <button id="lang-pl" class="lang-btn active px-3 py-1 text-xs font-medium">PL</button>
                            <button id="lang-en" class="lang-btn px-3 py-1 text-xs font-medium">EN</button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <section class="text-center mb-16">
                <h1 class="text-4xl md:text-5xl font-bold text-slate-100 tracking-tight" data-i18n-key="header.title"></h1>
                <p class="mt-4 text-lg text-muted-color max-w-3xl mx-auto" data-i18n-key="header.subtitle"></p>
            </section>

            <div id="strategy-selector" class="flex justify-center flex-wrap gap-4 mb-16 p-4 bg-black/30 border border-border-color shadow-inner">
                <button id="select-sdxl" class="version-btn active px-6 py-3 text-base font-medium" data-i18n-key="strategy.sdxl"></button>
                <button id="select-pony" class="version-btn px-6 py-3 text-base font-medium" data-i18n-key="strategy.pony"></button>
                <button id="select-hybrid" class="version-btn px-6 py-3 text-base font-medium" data-i18n-key="strategy.hybrid"></button>
            </div>

            <div id="sdxl-content">
                <section id="sdxl-blueprints" class="mb-24 scroll-mt-20">
                    <h2 class="text-3xl font-bold text-slate-100 mb-2" data-i18n-key="sdxl.blueprint.title"></h2>
                    <p class="text-muted-color mb-10 max-w-4xl" data-i18n-key="sdxl.blueprint.description"></p>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="card p-6 flex flex-col scanlines"><h3 class="font-bold text-lg text-slate-100">Animij [Illustrious] V5.0</h3><p class="text-sm font-medium text-secondary-color mb-2" data-i18n-key="sdxl.blueprint.card1.role"></p><p class="text-sm text-muted-color flex-grow" data-i18n-key="sdxl.blueprint.card1.desc"></p></div>
                        <div class="card p-6 flex flex-col scanlines"><h3 class="font-bold text-lg text-slate-100">Graycolor SemiRealIllustMix</h3><p class="text-sm font-medium text-secondary-color mb-2" data-i18n-key="sdxl.blueprint.card2.role"></p><p class="text-sm text-muted-color flex-grow" data-i18n-key="sdxl.blueprint.card2.desc"></p></div>
                        <div class="card p-6 flex flex-col scanlines"><h3 class="font-bold text-lg text-slate-100">Boomer Art Model v2.0</h3><p class="text-sm font-medium" style="color: #ff8c00;" data-i18n-key="sdxl.blueprint.card3.role"></p><p class="text-sm text-muted-color flex-grow" data-i18n-key="sdxl.blueprint.card3.desc"></p></div>
                        <div class="card p-6 flex flex-col scanlines"><h3 class="font-bold text-lg text-slate-100">D34D.CH4NN3L.SDXL</h3><p class="text-sm font-medium" style="color: #ff4545;" data-i18n-key="sdxl.blueprint.card4.role"></p><p class="text-sm text-muted-color flex-grow" data-i18n-key="sdxl.blueprint.card4.desc"></p></div>
                    </div>
                </section>
                <section id="sdxl-recipes" class="mb-24 scroll-mt-20">
                     <h2 class="text-3xl font-bold text-slate-100 mb-2" data-i18n-key="sdxl.recipes.title"></h2>
                     <div class="card p-6 md:p-8 mb-12 scanlines">
                         <h3 class="text-xl font-bold text-slate-100 mb-4" data-i18n-key="sdxl.recipes.step1.title"></h3>
                         <p class="text-sm text-muted-color mb-6" data-i18n-key="sdxl.recipes.step1.desc"></p>
                         <div class="flex justify-center flex-wrap gap-4 mb-6" id="sdxl-recipe-buttons">
                             <button data-recipe="balanced" class="recipe-btn active px-4 py-2 text-sm font-medium" data-i18n-key="sdxl.recipes.step1.btnBalanced"></button>
                             <button data-recipe="host_dominant" class="recipe-btn px-4 py-2 text-sm font-medium" data-i18n-key="sdxl.recipes.step1.btnHost"></button>
                             <button data-recipe="donor_receptive" class="recipe-btn px-4 py-2 text-sm font-medium" data-i18n-key="sdxl.recipes.step1.btnDonor"></button>
                         </div>
                         <div id="sdxl-recipe-explanation" class="mb-6 p-4 info-panel rounded-none text-sm"></div>
                         <div class="chart-container lazy-chart" id="sdxlChartContainer"><canvas id="sdxlChart"></canvas></div>
                         <div id="sdxl-justification" class="mt-6 p-4 bg-black/30 rounded-none text-sm text-muted-color min-h-[60px] border border-border-color" data-i18n-key="chart.hoverPrompt"></div>
                     </div>
                     <div class="card p-6 md:p-8 mb-12 scanlines">
                         <h3 class="text-xl font-bold text-slate-100 mb-4" data-i18n-key="sdxl.recipes.step2.title"></h3>
                         <p class="text-sm text-muted-color mb-6" data-i18n-key="sdxl.recipes.step2.desc"></p>
                         <div class="grid md:grid-cols-1 gap-8">
                             <div class="dare-panel">
                                 <h4 class="font-bold text-lg text-slate-200 mb-4 text-center" data-i18n-key="sdxl.recipes.step2a.title"></h4>
                                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                                     <div>
                                         <h5 class="text-sm font-semibold text-primary-color mb-2" data-i18n-key="dare.trim.title"></h5>
                                         <p class="text-xs text-muted-color mb-4" data-i18n-key="sdxl.recipes.step2a.trimDesc"></p>
                                         <p class="text-xs"><strong class="text-text-color">model_a:</strong> <span data-i18n-key="dare.hostFromStep1"></span></p>
                                         <p class="text-xs"><strong class="text-text-color">model_b:</strong> sd_xl_base_1.0</p>
                                         <p class="text-xs"><strong class="text-text-color">threshold:</strong> 0.60</p>
                                         <p class="text-xs"><strong class="text-text-color">threshold_type:</strong> quantile</p>
                                     </div>
                                     <div>
                                         <h5 class="text-sm font-semibold text-secondary-color mb-2" data-i18n-key="dare.merge.title"></h5>
                                         <p class="text-xs text-muted-color mb-4" data-i18n-key="dare.merge.desc"></p>
                                         <p class="text-xs"><strong class="text-text-color">model1:</strong> <span data-i18n-key="dare.hostFromStep1"></span></p>
                                         <p class="text-xs"><strong class="text-text-color">model2:</strong> Boomer Art Model</p>
                                         <p class="text-xs"><strong class="text-text-color">base_model:</strong> sd_xl_base_1.0</p>
                                         <p class="text-xs"><strong class="text-text-color">density:</strong> 0.45</p>
                                         <p class="text-xs"><strong class="text-text-color">ties_mode:</strong> sum</p>
                                     </div>
                                 </div>
                                 <div class="mt-6 pt-4 border-t border-border-color">
                                     <h5 class="text-sm font-semibold text-text-color mb-2" data-i18n-key="dare.justification"></h5>
                                     <p class="text-xs text-muted-color" data-i18n-key="sdxl.recipes.step2a.justification"></p>
                                 </div>
                             </div>
                         </div>
                     </div>
                </section>
            </div>
            
            <div id="pony-content" class="hidden">...</div>
             <div id="hybrid-content" class="hidden">...</div>

             <section id="analysis" class="mb-24 scroll-mt-20">...</section>
             <section id="glossary" class="mb-24 scroll-mt-20">...</section>
        </main>

        <footer class="bg-black/50 mt-24 border-t border-border-color">
            <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-sm text-muted-color">
                <p data-i18n-key="footer.text"></p>
            </div>
        </footer>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- Shader Background ---
    function initShaderBackground() {
        const canvas = document.getElementById('shader-canvas');
        try {
            const gl = canvas.getContext('webgl', { antialias: false, powerPreference: 'low-power' });
            if (!gl) { console.error("WebGL not supported"); return; }

            const vertexShaderSource = `attribute vec2 a_position; void main() { gl_Position = vec4(a_position, 0.0, 1.0); }`;
            const fragmentShaderSource = `
                precision highp float;
                uniform vec2 u_resolution;
                uniform float u_time;

                float random(vec2 st) { return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453); }
                
                float noise(vec2 st) {
                    vec2 i = floor(st); vec2 f = fract(st);
                    vec2 u = f*f*(3.0-2.0*f);
                    return mix(mix(random(i), random(i + vec2(1.0,0.0)), u.x),
                               mix(random(i + vec2(0.0,1.0)), random(i + vec2(1.0,1.0)), u.x), u.y);
                }

                float fbm(vec2 st) {
                    float value = 0.0;
                    float amp = 0.5;
                    for (int i=0; i<5; i++) {
                        value += amp * noise(st);
                        st *= 2.0;
                        amp *= 0.5;
                    }
                    return value;
                }

                void main() {
                    vec2 st = gl_FragCoord.xy/u_resolution.xy;
                    st.x *= u_resolution.x/u_resolution.y;
                    
                    float t = u_time * 0.1;
                    
                    vec2 q = vec2(fbm(st + t), fbm(st - t));
                    vec2 r = vec2(fbm(st + q*2.0 + t), fbm(st - q*2.0 - t));

                    float n = fbm(st*2.0 + q*1.5);
                    float m = fbm(st*1.5 - r*2.0);

                    vec3 color = vec3(n*0.2, m*0.1, fbm(st+r)*0.3);
                    color = pow(color, vec3(1.2));

                    gl_FragColor = vec4(color, 1.0);
                }`;
            
            function createShader(type, source) { const shader = gl.createShader(type); gl.shaderSource(shader, source); gl.compileShader(shader); if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) { console.error('Shader error: ' + gl.getShaderInfoLog(shader)); gl.deleteShader(shader); return null; } return shader; }
            const vertexShader = createShader(gl.VERTEX_SHADER, vertexShaderSource);
            const fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentShaderSource);
            const program = gl.createProgram(); gl.attachShader(program, vertexShader); gl.attachShader(program, fragmentShader); gl.linkProgram(program);
            if (!gl.getProgramParameter(program, gl.LINK_STATUS)) { console.error('Shader program error: ' + gl.getProgramInfoLog(program)); return; }
             
            const positionAttributeLocation = gl.getAttribLocation(program, "a_position");
            const resolutionUniformLocation = gl.getUniformLocation(program, "u_resolution");
            const timeUniformLocation = gl.getUniformLocation(program, "u_time");
             
            const positionBuffer = gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer); gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, 1, 1, 1, -1, -1, 1, -1]), gl.STATIC_DRAW);
            gl.useProgram(program);
            gl.enableVertexAttribArray(positionAttributeLocation);
            gl.vertexAttribPointer(positionAttributeLocation, 2, gl.FLOAT, false, 0, 0);

            let lastTime = 0;
            function render(time) {
                if(time - lastTime < 33) { // Cap at ~30fps
                     requestAnimationFrame(render);
                     return;
                }
                lastTime = time;
                time *= 0.001;
                if (gl.canvas.width !== gl.canvas.clientWidth || gl.canvas.height !== gl.canvas.clientHeight) {
                    gl.canvas.width = gl.canvas.clientWidth;
                    gl.canvas.height = gl.canvas.clientHeight;
                    gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);
                }
                gl.uniform2f(resolutionUniformLocation, gl.canvas.width, gl.canvas.height);
                gl.uniform1f(timeUniformLocation, time);
                gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
                requestAnimationFrame(render);
            }
            requestAnimationFrame(render);
        } catch (e) { console.error("WebGL init error:", e); }
    }

    // --- I18N and Data Store ---
    const i18nData = { /* The whole i18nData object remains here unchanged */ };
    let currentLanguage = 'pl';
    function setLanguage(lang) { /* Unchanged from previous version */ }

    // --- Charting Logic ---
    const blockLabels = ['IN00', 'IN01', 'IN02', 'IN03', 'IN04', 'IN05', 'IN06', 'IN07', 'IN08', 'IN09', 'IN10', 'IN11', 'M00', 'OUT00', 'OUT01', 'OUT02', 'OUT03', 'OUT04', 'OUT05', 'OUT06', 'OUT07', 'OUT08', 'OUT09', 'OUT10', 'OUT11'];
    
    // NEW: Per-block descriptions
    const blockDescriptions = {
        pl: [
            "IN00: Ustala najbardziej podstawową kompozycję i paletę kolorów.",
            "IN01: Wpływa na ogólne kształty i podstawową anatomię postaci.",
            "IN02: Kontynuuje definiowanie struktury, pozy i głównych elementów.",
            "IN03: Zaczyna wprowadzać wczesne elementy stylistyczne do anatomii.",
            "IN04: Kluczowy blok dla spójności anatomicznej; balansuje styl i strukturę.",
            "IN05: Kształtuje główne cechy i elementy tematyczne (np. ubranie).",
            "IN06: Dalsze mieszanie stylu z anatomią, konkretyzacja tematu.",
            "IN07: Silny wpływ na styl, przy mniejszym wpływie na bazową kompozycję.",
            "IN08: Wprowadza bardziej szczegółowe elementy stylistyczne i tekstury.",
            "IN09: Kluczowy dla spójności stylu przed blokiem środkowym.",
            "IN10: Finalizuje styl wejściowy przed interpretacją koncepcyjną.",
            "IN11: Ostatni blok wejściowy, cementuje styl przed rdzeniem.",
            "M00 (Rdzeń): Interpretuje główną koncepcję i temat promptu.",
            "OUT00: Rozpoczyna rekonstrukcję obrazu z rdzenia, wpływa na wczesne detale.",
            "OUT01: Dalsze definiowanie detali i wczesnych tekstur powierzchni.",
            "OUT02: Kluczowy dla wczesnego oświetlenia i cieniowania.",
            "OUT03: Równoważy detale i ogólny styl na wczesnym etapie renderowania.",
            "OUT04: Wpływa na średniej wielkości detale i wykończenie powierzchni.",
            "OUT05: Dalsze udoskonalanie tekstur, nadawanie materiałom właściwości.",
            "OUT06: Odpowiada za drobne detale i czystość krawędzi (lineart).",
            "OUT07: Wpływa na mikro-detale, takie jak wzory na tkaninach.",
            "OUT08: Finalizuje wygląd linii, dodaje subtelne efekty (np. poświata).",
            "OUT09: Polerowanie obrazu, usuwanie drobnych artefaktów.",
            "OUT10: Ostatnie poprawki, wpływa na ostrość i czystość obrazu.",
            "OUT11: Ostateczne wykończenie, zapewnia spójność kolorów i detali."
        ],
        en: [
            "IN00: Establishes the most basic composition and color palette.",
            "IN01: Influences overall shapes and fundamental character anatomy.",
            "IN02: Continues to define structure, pose, and major elements.",
            "IN03: Begins to introduce early stylistic elements into the anatomy.",
            "IN04: Crucial block for anatomical coherence; balances style and structure.",
            "IN05: Shapes the main features and thematic elements (e.g., clothing).",
            "IN06: Further blending of style with anatomy, solidifying the theme.",
            "IN07: Strong influence on style, with less impact on the base composition.",
            "IN08: Introduces more detailed stylistic elements and textures.",
            "IN09: Key for style coherence before the middle block.",
            "IN10: Finalizes the input style before conceptual interpretation.",
            "IN11: The last input block, cementing the style before the core.",
            "M00 (Core): Interprets the main concept and theme of the prompt.",
            "OUT00: Begins reconstructing the image from the core, affects early details.",
            "OUT01: Further defines details and early surface textures.",
            "OUT02: Crucial for early lighting and shading.",
            "OUT03: Balances details and overall style in the early rendering stage.",
            "OUT04: Affects medium-sized details and surface finishing.",
            "OUT05: Further refines textures, giving materials their properties.",
            "OUT06: Responsible for fine details and the cleanliness of edges (lineart).",
            "OUT07: Influences micro-details, such as patterns on fabric.",
            "OUT08: Finalizes the look of lines, adds subtle effects (e.g., glow).",
            "OUT09: Polishes the image, removing minor artifacts.",
            "OUT10: Adds final touches, affects sharpness and image clarity.",
            "OUT11: Final finishing, ensures color and detail consistency."
        ]
    };

    // Unchanged from previous: chartDataStore, lazyCharts, chartObserver
    let sdxlChartInstance, ponyChartInstance, hybridChartInstance;
    
    // UPDATED: Hover callback to use per-block descriptions
    const onBlockHover = (justificationEl) => (e, el) => {
        if (el.length > 0) {
            const blockIndex = el[0].index;
            justificationEl.innerHTML = `<strong>[${blockLabels[blockIndex]}]</strong>: ${blockDescriptions[currentLanguage][blockIndex]}`;
        } else {
            justificationEl.innerHTML = i18nData[currentLanguage]['chart.hoverPrompt'];
        }
    };
    
    function createChart(ctx, onHoverCallback) {
        return new Chart(ctx, {
            type: 'bar',
            options: {
                responsive: true, maintainAspectRatio: false,
                animation: { duration: 800 },
                plugins: {
                    tooltip: { 
                        mode: 'index', intersect: false, 
                        callbacks: { 
                            label: (c) => {
                                const modelALabel = c.chart.data.datasets[0].label;
                                const modelBLabel = c.chart.data.datasets[1].label;
                                const modelBWeight = c.chart.data.datasets[1].data[c.dataIndex];
                                const modelAWeight = 1 - modelBWeight;
                                
                                if (c.datasetIndex === 0) {
                                     return `${modelALabel}: ${(modelAWeight * 100).toFixed(0)}%`;
                                }
                                return `${modelBLabel}: ${(modelBWeight * 100).toFixed(0)}%`;
                            }
                        },
                        backgroundColor: 'rgba(13, 12, 29, 0.8)', titleFont: { weight: 'bold', family: "'Orbitron', sans-serif" }, bodyFont: { size: 12, family: "'Roboto Mono', monospace"}, borderColor: 'var(--border-color)', borderWidth: 1,
                    },
                    legend: { position: 'top', labels: { color: 'var(--text-color)', font: { family: "'Orbitron', sans-serif" } } }
                },
                scales: {
                    x: { stacked: true, grid: { display: false }, ticks: { color: 'var(--text-muted-color)', font: { family: "'Roboto Mono', monospace" } } },
                    y: { stacked: true, beginAtZero: true, max: 1.0, grid: { color: 'rgba(0, 240, 255, 0.1)' }, ticks: { color: 'var(--text-muted-color)', font: { family: "'Roboto Mono', monospace" }, callback: (v) => (v * 100) + '%' } }
                },
                onHover: onHoverCallback
            }
        });
    }

    // --- All init and update chart functions (initializeSdxlChart, updateSdxlChart, etc.) are unchanged ---
    // --- They will now use the new onBlockHover callback and styles from createChart automatically ---
    
    // --- Initial state ---
    initShaderBackground();
    // Fill in the rest of the page structure from your previous version here.
    // The script part from the previous response should be copied here, starting from `setLanguage('pl');`
    setLanguage('pl');
    switchVersion('sdxl');
});
</script>
</body>
</html>
